#!/bin/bash

base="${0%/*}/../share/elm-new"
beginner=0
path="."


for arg in "$@"; do
  case $arg in

    # Print help
    -h|--help)
      echo "usage: elm-new [-V|--version] [-h|--help] [-b|--beginner] [path]"
      exit
      ;;

    # Print version
    -V|--version)
      echo "1.0.0"
      exit
      ;;

    # Set flag for generating a beginnerProgram
    -b|--beginner)
      beginner=1
      shift
      ;;

    # Unknown
    -*)
      echo "elm-new: illegal option -- $arg"
      elm-new --help
      exit 1
      ;;

    # Set flag for generating in specified path
    *)
      path="$1"
      shift
      ;;
  esac
done


cp -R "$base/" $path


if [ "$beginner" = 1 ] ; then
  mv "$path/src/MainBeginner.elm" "$path/src/Main.elm"
else
  rm "$path/src/MainBeginner.elm"
fi


tree -a $path 2>/dev/null


printf "\nYour Elm program has been created successfully.\n"
printf "You can use \"elm-make\" to compile it:\n\n"
printf "    elm-make src/Main.elm\n\n"
printf "Run \"elm\" for more commands.\n\n"
